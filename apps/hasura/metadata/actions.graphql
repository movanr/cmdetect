type Query {
  getPatientProgress(
    invite_token: String!
  ): PatientProgressResponse!
}

type Mutation {
  submitPatientConsent(
    invite_token: String!
    consent_data: ConsentInput!
  ): ConsentResponse!
}

type Mutation {
  submitPatientPersonalData(
    invite_token: String!
    patient_data: PatientPersonalDataInput!
  ): PatientPersonalDataResponse!
}

type Mutation {
  submitQuestionnaireResponse(
    invite_token: String!
    response_data: QuestionnaireResponseInput!
  ): QuestionnaireResponseResponse!
}

type Mutation {
  validateInviteToken(
    invite_token: String!
  ): ValidateInviteTokenResponse!
}

input ConsentInput {
  consent_given: Boolean!
  consent_text: String!
  consent_version: String!
  ip_address: String
  user_agent: String
}

input QuestionnaireResponseInput {
  questionnaire_id: String!
  questionnaire_version: String!
  answers: jsonb!
}

input ValidateInviteTokenInput {
  invite_token: String!
}

input PatientPersonalDataInput {
  first_name_encrypted: String!
  last_name_encrypted: String!
  date_of_birth_encrypted: String!
}

type ConsentResponse {
  success: Boolean!
  patient_consent_id: uuid
  error: String
}

type QuestionnaireResponseResponse {
  success: Boolean!
  questionnaire_response_id: uuid
  error: String
}

type ValidateInviteTokenResponse {
  valid: Boolean!
  organization_name: String
  public_key_pem: String
  patient_record_id: uuid
  expires_at: String
  error_message: String
}

type PatientPersonalDataResponse {
  success: Boolean!
  patient_record_id: uuid
  message: String
  error: String
}

type PatientProgressResponse {
  valid: Boolean!
  has_consent: Boolean!
  consent_given: Boolean!
  has_personal_data: Boolean!
  submitted_questionnaires: [String!]!
  error_message: String
}

